<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Structlog with Django is Awesome! | loop0</title><link rel=stylesheet href=/css/main.min.dcef7cc0d936669d48f826b8506f535e45697c0dc785b3d8af214477a0ce3df4.css integrity="sha256-3O98wNk2Zp1I+Ca4UG9TXkVpfA3HhbPYryFEd6DOPfQ=" crossorigin=anonymous></head><body><header><h1>loop0
<a href=https://freeradical.zone/@loop0 rel=me class=social><svg width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentcolor" d="M20.94 14c-.28 1.41-2.44 2.96-4.97 3.26-1.31.15-2.6.3-3.97.24-2.25-.11-4-.54-4-.54v.62c.32 2.22 2.22 2.35 4.03 2.42 1.82.05 3.44-.46 3.44-.46l.08 1.65s-1.28.68-3.55.81c-1.25.07-2.81-.03-4.62-.5-3.92-1.05-4.6-5.24-4.7-9.5l-.01-3.43c0-4.34 2.83-5.61 2.83-5.61C6.95 2.3 9.41 2 11.97 2h.06c2.56.0 5.02.3 6.47.96.0.0 2.83 1.27 2.83 5.61.0.0.04 3.21-.39 5.43M18 8.91c0-1.08-.3-1.91-.85-2.56-.56-.63-1.3-.96-2.23-.96-1.06.0-1.87.41-2.42 1.23l-.5.88-.5-.88c-.56-.82-1.36-1.23-2.43-1.23-.92.0-1.66.33-2.23.96C6.29 7 6 7.83 6 8.91v5.26h2.1V9.06c0-1.06.45-1.62 1.36-1.62 1 0 1.5.65 1.5 1.93v2.79h2.07V9.37c0-1.28.5-1.93 1.51-1.93.9.0 1.35.56 1.35 1.62v5.11H18V8.91z"/></svg>
</a><a href=https://github.com/loop0 rel=me class=social><svg width="1em" height="1em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a></h1><nav><ul class=top-menu><li><a href=/>home</a></li><li><a aria-current=true class=ancestor href=/posts/>posts</a></li><li><a href=/tags/>tags</a></li></ul></nav></header><main><h1>Structlog with Django is Awesome!</h1><time datetime=2024-03-06T12:04:59-05:00>March 6, 2024</time><h2 id=structlog>Structlog</h2><p>If you haven&rsquo;t heard about <a href=https://www.structlog.org>structlog</a> yet, you are missing out!
Structlog is this awesome python library that improves the standard python logging features.
You can struct your logs very easily as key=value or json, it also has a neat way of showing logs
when doing local development, like this:</p><p><img src=/console_renderer.png alt="Console Renderer"></p><h2 id=django>Django</h2><p>It turns out it is very simple to have it working on Django as well, all you need is to add the following
to your <code>settings.py</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> structlog
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LOGGING <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;version&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;disable_existing_loggers&#34;</span>: <span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;formatters&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;json_formatter&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;()&#34;</span>: structlog<span style=color:#f92672>.</span>stdlib<span style=color:#f92672>.</span>ProcessorFormatter,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;processor&#34;</span>: structlog<span style=color:#f92672>.</span>processors<span style=color:#f92672>.</span>JSONRenderer(),
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;plain_console&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;()&#34;</span>: structlog<span style=color:#f92672>.</span>stdlib<span style=color:#f92672>.</span>ProcessorFormatter,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;processor&#34;</span>: structlog<span style=color:#f92672>.</span>dev<span style=color:#f92672>.</span>ConsoleRenderer(),
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;key_value&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;()&#34;</span>: structlog<span style=color:#f92672>.</span>stdlib<span style=color:#f92672>.</span>ProcessorFormatter,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;processor&#34;</span>: structlog<span style=color:#f92672>.</span>processors<span style=color:#f92672>.</span>KeyValueRenderer(key_order<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;timestamp&#39;</span>, <span style=color:#e6db74>&#39;level&#39;</span>, <span style=color:#e6db74>&#39;event&#39;</span>, <span style=color:#e6db74>&#39;logger&#39;</span>]),
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;handlers&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;console&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;class&#34;</span>: <span style=color:#e6db74>&#34;logging.StreamHandler&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;formatter&#34;</span>: <span style=color:#e6db74>&#34;plain_console&#34;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;root&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;handlers&#34;</span>: [<span style=color:#e6db74>&#34;console&#34;</span>],
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;level&#34;</span>: <span style=color:#e6db74>&#34;INFO&#34;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>structlog<span style=color:#f92672>.</span>configure(
</span></span><span style=display:flex><span>    processors<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>        structlog<span style=color:#f92672>.</span>stdlib<span style=color:#f92672>.</span>filter_by_level,
</span></span><span style=display:flex><span>        structlog<span style=color:#f92672>.</span>processors<span style=color:#f92672>.</span>TimeStamper(fmt<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;iso&#34;</span>),
</span></span><span style=display:flex><span>        structlog<span style=color:#f92672>.</span>stdlib<span style=color:#f92672>.</span>add_logger_name,
</span></span><span style=display:flex><span>        structlog<span style=color:#f92672>.</span>stdlib<span style=color:#f92672>.</span>add_log_level,
</span></span><span style=display:flex><span>        structlog<span style=color:#f92672>.</span>stdlib<span style=color:#f92672>.</span>PositionalArgumentsFormatter(),
</span></span><span style=display:flex><span>        structlog<span style=color:#f92672>.</span>processors<span style=color:#f92672>.</span>StackInfoRenderer(),
</span></span><span style=display:flex><span>        structlog<span style=color:#f92672>.</span>processors<span style=color:#f92672>.</span>format_exc_info,
</span></span><span style=display:flex><span>        structlog<span style=color:#f92672>.</span>processors<span style=color:#f92672>.</span>UnicodeDecoder(),
</span></span><span style=display:flex><span>        structlog<span style=color:#f92672>.</span>stdlib<span style=color:#f92672>.</span>ProcessorFormatter<span style=color:#f92672>.</span>wrap_for_formatter,
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    context_class<span style=color:#f92672>=</span>dict,
</span></span><span style=display:flex><span>    logger_factory<span style=color:#f92672>=</span>structlog<span style=color:#f92672>.</span>stdlib<span style=color:#f92672>.</span>LoggerFactory(),
</span></span><span style=display:flex><span>    cache_logger_on_first_use<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>To check the other formatters you just need to change the formatter in the console handler.
This should give you enough to get started, and if you want to add more features like automatic
context make sure to check out <a href=https://django-structlog.readthedocs.io/en/latest/index.html>django-structlog</a>.</p><p>Now all you have to do is when you want to log something just make sure to use <code>structlog.get_logger</code> function
to get your configured logger, like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> structlog
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>logger <span style=color:#f92672>=</span> structlog<span style=color:#f92672>.</span>get_logger()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#34;User logged in&#34;</span>, user_id<span style=color:#f92672>=</span>request<span style=color:#f92672>.</span>user<span style=color:#f92672>.</span>id)
</span></span></code></pre></div><h2 id=do-you-want-to-hire-me>Do you want to hire me?</h2><p>Are you in need of a seasoned web developer with over 15 years of experience? Look no further!
I&rsquo;ve worked with numerous startups, playing a pivotal role in scaling engineering teams from 10 to 150 engineers.
My expertise spans the entire software development lifecycle, from gathering requirements to implementing solutions,
conducting automated testing, and setting up automated infrastructure and deployment processes.</p><p>Whether you&rsquo;re looking to tackle a specific project or need ongoing support, I&rsquo;m here to help.
Reach out to me at <a href=mailto:hire@loop0.sh>hire@loop0.sh</a> to learn more about how my skills and experience can benefit your company.
Let&rsquo;s discuss how I can contribute to your team&rsquo;s success!</p><p><code>#python</code> <code>#django</code> <code>#go</code> <code>#rest</code> <code>#api</code> <code>#aws</code> <code>#kubernetes</code> <code>#cicd</code> <code>#redis</code> <code>#postgresql</code> <code>#mysql</code> <code>#linux</code></p></main><footer><p class=terminal>null@loop0.sh $ <span class=blink>_</span></p></footer></body></html>